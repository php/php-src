version: "{branch}.build.{build}"

image: Visual Studio 2019

clone_depth: 1

skip_commits:
  files:
    - docs/*
    - NEWS
    - UPGRADING
    - UPGRADING.INTERNALS

environment:
  PHP_BUILD_CACHE_BASE_DIR: C:\build-cache
  PHP_BUILD_OBJ_DIR: C:\obj
  PHP_BUILD_CACHE_SDK_DIR: C:\build-cache\sdk
  PHP_BUILD_SDK_BRANCH: php-sdk-2.2.0
  PHP_BUILD_CRT: vs16
  matrix:
    - THREAD_SAFE: ""
    - THREAD_SAFE: 1
      INTRINSICS: AVX2

services:
  - mysql
  - postgresql101
  - mssql2017

platform:
  - x64
  #- x86

build_script:
  - .github\scripts\windows\build.bat

test_script:
  - .github\scripts\windows\test.bat
