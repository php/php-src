--TEST--
iconv_set_encoding() charset parameter length checks (CVE-2007-4840)
--EXTENSIONS--
iconv
--FILE--
<?php
$a = str_repeat("/", 9000000);
var_dump(iconv_set_encoding("input_encoding", $a));
var_dump(iconv_set_encoding("output_encoding", $a));
var_dump(iconv_set_encoding("internal_encoding", $a));
?>
--EXPECTF--

Deprecated: Function iconv_set_encoding() is deprecated since 8.5, use internal_encoding, input_encoding, and output_encoding INI settings instead in %s on line %d

Warning: iconv_set_encoding(): Encoding parameter exceeds the maximum allowed length of 64 characters in %s on line %d
bool(false)

Deprecated: Function iconv_set_encoding() is deprecated since 8.5, use internal_encoding, input_encoding, and output_encoding INI settings instead in %s on line %d

Warning: iconv_set_encoding(): Encoding parameter exceeds the maximum allowed length of 64 characters in %s on line %d
bool(false)

Deprecated: Function iconv_set_encoding() is deprecated since 8.5, use internal_encoding, input_encoding, and output_encoding INI settings instead in %s on line %d

Warning: iconv_set_encoding(): Encoding parameter exceeds the maximum allowed length of 64 characters in %s on line %d
bool(false)
