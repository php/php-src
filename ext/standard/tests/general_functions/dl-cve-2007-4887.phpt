--TEST--
dl() filename length checks (CVE-2007-4887)
--SKIPIF--
<?php
$enabled_sapi = array('cgi-fcgi', 'cli', 'embed', 'fpm');
if (!in_array(php_sapi_name(), $enabled_sapi)) {
	die('skip dl() is not enabled for ' . php_sapi_name());
}
?>
--INI--
enable_dl=1
--FILE--
<?php

try {
    var_dump(dl(str_repeat("a", 8376757)));
} catch (ValueError $exception) {
    echo $exception->getMessage() . "\n";
}

?>
--EXPECTF--
dl(): Argument #1 ($extension_filename) must be shorter than %d bytes
